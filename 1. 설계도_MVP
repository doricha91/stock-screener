🧭 주식 선별 프로그램 프로젝트 설계도 (초안)
1. 프로젝트의 목적
이 프로젝트의 목적은 미국 주식 시장을 대상으로, 사용자가 정의한 **복합 전략(기술적/기본적/패턴)**에 따라 '매수', '매도', '보유' 대상 종목을 **자동으로 선별(Screening)**하고 리포트하는 확장 가능한 프로그램을 구축하는 것입니다.
- 초기 목표: '터틀 트레이딩' 전략을 구현합니다.
- 장기 목표: 다양한 전략 모듈을 추가하고, 한국 주식 시장까지 확장 가능한 유연한 구조를 확보합니다.

2. 프로젝트의 핵심 기능
사용자의 초기 요구사항(1.1~1.5)과 논의된 내용을 바탕으로 기능을 구체화했습니다.
- 데이터 수집: Alpha Vantage API를 통해 미국 주식의 주가(OHLCV), 거래량, 기본 재무 지표(시가총액 등) 데이터를 수집합니다.
- 기본 필터링: 분석 대상을 선별하기 위해 최소 시가총액, 최소 일평균 거래대금, 최소 주가 등의 조건으로 1차 필터링을 수행합니다.

전략 분석 (초기: 터틀 트레이딩):
N일 신고가 / 신저가 계산 (진입/청산 신호)
ATR (Average True Range) 계산 (손절 및 변동성 관리)

의사결정 (신호 생성):
신규 주식: 필터링된 전체 종목 중 터틀 트레이딩 '매수' 신호가 발생한 종목을 선별합니다.
보유 주식: (향후 구현) 현재 보유 중인 종목에 대해 '매도' 또는 '보유' 신호를 생성합니다.
AI 연동 (확장): OpenAI API를 활용하여 선별된 종목의 최신 뉴스나 시장의 전반적인 감성을 분석하는 기능을 추가합니다.

리포팅: 최종 선별된 종목 리스트와 그 이유(신호 발생 근거)를 콘솔 또는 파일(CSV, TXT)로 출력합니다.

3. 프로젝트의 구성요소 (Tools & Tech)
프로젝트를 구축하고 실행하는 데 필요한 도구와 기술입니다.

- 개발 언어: Python (3.11)
- 핵심 라이브러리:
pandas: 데이터 처리, 분석, 기술적 지표 계산의 핵심.
requests: API 데이터 호출 및 통신.
openai: GPT 모델 연동.
pandas_ta (선택적): ATR 등 다양한 기술적 지표를 더 쉽게 계산하기 위해 활용 가능.
데이터 소스 (API): Alpha Vantage (주가, 재무 데이터)
개발 환경: PyCharm (사용자 선호)
형상 관리 (추가 제안): Git / GitHub (코드 변경 이력 관리, 백업, 협업)

4. 코드의 모듈들 (리스트)
프로젝트를 구성할 핵심 파일(모듈)들의 목록과 각 모듈의 역할입니다. (시나리오 A: 신규 프로젝트 기준)

- data 폴더
역할: 주가 및 지표 데이터 저장

- reports 폴더
역할: 주간 또는 일간 선정 종목 및 로그 저장

- main.py
설명: 프로젝트의 메인 실행 파일(Entry Point).
역할:
1. 전체 스크리닝 프로세스(데이터 수집 → 필터링 → 전략 분석)를 순차적으로 호출하고 조율합니다.
2. screener.py로부터 최종 선별된 종목 리스트를 받습니다.
3. utils.py를 이용해 현재 날짜/시간으로 파일명(예: report_20251108.csv)을 생성하여 reports 폴더에 저장합니다.

- config.py
설명: 설정 및 민감 정보 관리.
역할: Alpha Vantage API 키, OpenAI API 키, 전략 설정값(예: 터틀 트레이딩의 N일=20일), 필터링 기준(최소 시총 10억 달러) 등 변경이 잦거나 민감한 정보를 저장합니다.

- data_manager.py (또는 api_handler.py)
설명: 데이터 수집 및 캐싱(Caching) 전용 모듈.
역할:
1. data 폴더에 요청한 종목의 데이터(예: AAPL.csv)가 있는지, 그리고 최신인지 확인합니다.
2. 유효한 데이터가 없으면, Alpha Vantage API에 연결하여 주가(OHLCV) 데이터를 요청합니다.
3. 받아온 데이터를 data 폴더에 CSV 파일 등으로 저장(캐싱)합니다.
4. 데이터를 Pandas DataFrame 형태로 반환합니다.

- indicator.py
설명: 기술적 지표 계산 모듈
역할: data_manager.py 가 수집한 데이터를 전략에 맞게 가공하는 모듈

- strategy.py
설명: '터틀 트레이딩' 전략 로직.
역할: 주가 데이터(DataFrame)를 입력받아 N일 신고가/신저가, ATR을 계산하고, 최종적으로 '매수(Buy)', '매도(Sell)', '보유(Hold)' 신호를 생성하는 함수를 포함합니다.
추후 '터틀 트레이딩' 외 다른 전략도 추가할 수 있도록 확장성을 가지게 코딩 필요

- screener.py
설명: 종목 선별기 및 필터링.
역할:
1. 분석 대상이 될 종목 리스트(예: S&P 500)를 정의하고, config.py의 기준에 따라 1차 필터링을 수행합니다.
2. data_manager로 데이터를 가져오고 indicator로 기술적 지표를 계산합니다.
3. 계산된 데이터를 strategy 모듈에 넘겨 최종 종목 리스트를 선별합니다.
4. 선별된 최종 종목 리스트(DataFrame 또는 list)를 main.py에 **반환(return)**합니다.

- ai_helper.py (또는 openai_service.py)
설명: OpenAI API 연동 모듈.
역할: 특정 프롬프트(예: "이 시장 상황은 긍정적인가?")를 받아 OpenAI API를 호출하고, 그 결과를 정제하여 반환하는 함수를 포함합니다.

- utils.py (또는 common.py)
설명: 공통 보조 함수.
역할: 로그 기록, 파일 저장/읽기, 날짜 계산 등 여러 모듈에서 공통으로 사용되는 작은 헬퍼 함수들을 모아둡니다.

5. 개발 단계 (Roadmap)

1단계 (환경 설정): 프로젝트 폴더 구조 생성 (data, reports 폴더 포함), config.py에 API 키 설정, Git 초기화.
2단계 (데이터 수집): data_manager.py 구현. (목표: 'AAPL' 1년치 주가 데이터 가져오기 및 data 폴더에 AAPL.csv로 저장/로드 성공)
3단계 (지표 계산): indicator.py 구현. (목표: 'AAPL' DataFrame을 받아 ATR, 20일 신고가/신저가 값이 포함된 DataFrame 반환 성공)
4단계 (전략 구현): strategy.py 구현. (목표: 지표가 계산된 DataFrame을 받아 'Buy', 'Sell', 'Hold' 신호(Signal)를 생성하는 로직 구현 성공)
5단계 (스크리너 구현): screener.py와 main.py 구현. (목표: 10개 종목 리스트 중 'Buy' 신호가 뜬 종목만 reports 폴더에 report_날짜.csv 파일로 저장 성공)
6단계 (고도화): AI 연동, 필터링 조건 추가, 리포팅 양식 개선.